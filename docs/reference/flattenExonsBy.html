<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Flatten exons by gene or transcript — flattenExonsBy • splicejam</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Flatten exons by gene or transcript — flattenExonsBy" />
<meta property="og:description" content="Flatten exons by gene or transcript" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">splicejam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.63.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/basic-rnaseq-workflow.html">Splicejam basic RNAseq workflow</a>
    </li>
    <li>
      <a href="../articles/create-a-sashimi-plot.html">Create a Sashimi Plot</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/jmw86069/splicejam/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Flatten exons by gene or transcript</h1>
    <small class="dont-index">Source: <a href='http://github.com/jmw86069/splicejam/blob/master/R/jambio-tx.R'><code>R/jambio-tx.R</code></a></small>
    <div class="hidden name"><code>flattenExonsBy.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Flatten exons by gene or transcript</p>
    </div>

    <pre class="usage"><span class='fu'>flattenExonsBy</span><span class='op'>(</span>
  <span class='va'>exonsByTx</span>,
  <span class='va'>tx2geneDF</span>,
  by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"gene"</span>, <span class='st'>"tx"</span><span class='op'>)</span>,
  detectedTx <span class='op'>=</span> <span class='cn'>NULL</span>,
  genes <span class='op'>=</span> <span class='cn'>NULL</span>,
  txColname <span class='op'>=</span> <span class='st'>"transcript_id"</span>,
  geneColname <span class='op'>=</span> <span class='st'>"gene_name"</span>,
  cdsByTx <span class='op'>=</span> <span class='cn'>NULL</span>,
  cdsByGene <span class='op'>=</span> <span class='cn'>NULL</span>,
  filterTwoStrand <span class='op'>=</span> <span class='cn'>FALSE</span>,
  exon_method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"disjoin"</span>, <span class='st'>"reduce"</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>exonsByTx</th>
      <td><p>GRangesList named by transcript, containing one or
more GRanges representing exons. This data is often produced
from <code>TxDb</code> data using <code><a href='https://rdrr.io/pkg/GenomicFeatures/man/transcriptsBy.html'>GenomicFeatures::exonsBy(...,by="tx")</a></code>.</p></td>
    </tr>
    <tr>
      <th>tx2geneDF</th>
      <td><p>data.frame containing at least two columns with
transcript and gene annotation, whose colnames are defined by
arguments <code>txColname</code> and <code>geneColname</code> respectively. When
using a GTF file, <code><a href='makeTx2geneFromGtf.html'>makeTx2geneFromGtf()</a></code> can be used to
create a <code>tx2geneDF</code> in <code>data.frame</code> format.</p></td>
    </tr>
    <tr>
      <th>by</th>
      <td><p>character string to group exons, <code>"gene"</code> groups multiple
transcripts per gene, and <code>"tx"</code> groups exons per transcript.
Note that in both cases, it combines <code>exonsByTx</code> and <code>cdsByTx</code>
when <code>cdsByTx</code> is also supplied.</p></td>
    </tr>
    <tr>
      <th>detectedTx</th>
      <td><p>character vector of detected transcripts, used to
subset the overall transcripts prior to producing a flattened gene
exon model.</p></td>
    </tr>
    <tr>
      <th>genes</th>
      <td><p>optional character vector, representing a subset of
genes for which flattened exons will be prepared. This argument
is useful when focusing on only one or a subset of genes.</p></td>
    </tr>
    <tr>
      <th>txColname</th>
      <td><p>character string indicating a column from
<code><a href='https://rdrr.io/r/base/colnames.html'>colnames(tx2geneDF)</a></code> used to identify transcripts.</p></td>
    </tr>
    <tr>
      <th>geneColname</th>
      <td><p>character string indicating a column from
<code><a href='https://rdrr.io/r/base/colnames.html'>colnames(tx2geneDF)</a></code> used to identify gene name, or gene symbol.</p></td>
    </tr>
    <tr>
      <th>cdsByTx</th>
      <td><p><code>GRangesList</code> named by transcript, containing <code>GRanges</code>
exons that only include CDS regions. This data is often produced
from <code>TxDb</code> data using <code><a href='https://rdrr.io/pkg/GenomicFeatures/man/transcriptsBy.html'>GenomicFeatures::cdsBy(...,by="tx")</a></code>.</p></td>
    </tr>
    <tr>
      <th>cdsByGene</th>
      <td><p><code>GRangesList</code> named by gene, containing <code>GRanges</code>
exons that only include CDS regions. This data is often produced
from <code>TxDb</code> data using <code><a href='https://rdrr.io/pkg/GenomicFeatures/man/transcriptsBy.html'>GenomicFeatures::cdsBy(...,by="gene")</a></code>.
Note this input is only used when <code>by="gene"</code>.</p></td>
    </tr>
    <tr>
      <th>filterTwoStrand</th>
      <td><p><code>logical</code> indicating whether genes on multiple
strands are removed during <code><a href='assignGRLexonNames.html'>assignGRLexonNames()</a></code> which assigns
ordered exon numbers for each unique gene. Setting this to <code>FALSE</code>
may cause exon numbers to be incorrect, but it will retain all
genes. When this argument is <code>TRUE</code> any genes present on multiple
strands are removed.</p></td>
    </tr>
    <tr>
      <th>exon_method</th>
      <td><p><code>character</code> string indicating the method to use
when combining transcript exons by gene: <code>"disjoin"</code> maintains
the internal boundaries for overlapping exons, so overlapping
exons of different width will be sub-divided; <code>"reduce"</code>
combines overlapping exons into one larger exon that is not
sub-divided. The <code>"reduce"</code> method is substantially faster,
but loses the ability to match a specific exon region to its
source transcript isoform(s). Note that when <code>cdsByExon</code> is
also supplied, exons will be sub-divided at the point where
an exon goes from CDS-overlapping, to non-coding.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical indicating whether to print verbose output.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>GRangesList</code> with names dependent upon argument <code>by</code>:
when <code>by="gene"</code> names are derived from values in <code>geneColname</code>;
when <code>by="tx"</code> names are derived from values in <code>txColname</code>.
Each entry in the <code>GRangesList</code> will contain a series of
non-overlapping <code>GRanges</code> each representing an exon. The exon
names are described above.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function takes as input:</p><ul>
<li><p><code>exonsByTx</code> as a <code>GRangesList</code> object
of transcript exons named by the <code>transcript_id</code></p></li>
<li><p><code>tx2geneDF</code> a <code>data.frame</code> with transcript-gene cross-reference</p></li>
<li><p><code>detectedTx</code> an optional character vector of <code>transcript_id</code>
values, used to subset the overall transcripts</p></li>
<li><p><code>cdsByTx</code> an optional <code>GRangesList</code> object, similar to <code>exonsByTx</code>
except that it only contains the CDS portion of exons</p></li>
</ul>

<p>When <code>by="gene"</code> this function groups exons from one or more
transcript isoforms together by gene, to produce a single
non-overlapping set of exons that describe each gene. When <code>cdsByTx</code>
is provided, the output is useful in showing which regions of
an exon is coding (CDS), and which regions are non-coding.
When <code>exon_method="disjoin"</code> the output also maintains any
internal exon boundaries wherever multiple exons overlap.</p>
<p>When <code>by="tx"</code> this function is primarily used to combine
<code>exonsByTx</code> with optional <code>cdsByTx</code> in order to sub-divide
exons into regions which are coding (CDS) and non-coding.</p>
<p>The use of <code>detectedTx</code> has appeared to be very helpful in
reducing the overall complexity of the flattened gene-exon
models, specifically reducing the number of low-quality
predicted transcripts that are represented.</p>
<p>Finally, this function calls <code><a href='assignGRLexonNames.html'>assignGRLexonNames()</a></code> to label
exons using a defined naming scheme:</p><ul>
<li><p>Contiguous exons are numbered in order, starting at <code>1</code> and
increasing in the coding direction (strand-specific.) For
example exons will be numbered: <code>exon1</code>, <code>exon2</code>, <code>exon3</code>.</p></li>
<li><p>Exons which are sub-divided, are indicated with an lowercase
character letter, for example: <code>exon1a</code>, <code>exon1b</code>, <code>exon1c</code>.</p></li>
</ul>

<p>A text schematic is shown below:</p>
<pre>
|=======|======|......|=======|.....|=======|=======|=======|

|_exon1a|exon1b|......|_exon2_|.....|_exon3a|_exon3b|_exon3c|
</pre>

<p>Where</p><ul>
<li><p><code>|====|</code> represents an exon,</p></li>
<li><p><code>|====|====|</code> represents one contiguous exon with two
sub-divided parts, and</p></li>
<li><p><code>|.....|</code> represents an intron.</p></li>
</ul>

<p>It is recommended but not required to supply <code>detectedTx</code>,
since it can greatly reduce the total number of transcripts.
This step has two benefits:</p><ol>
<li><p>Supplying <code>detectedTx</code> can greatly simplify the
resulting gene-exon models.</p></li>
<li><p>Supplying <code>detectedTx</code> has the by-product of
removing potentially erroneous transcripts from the
source annotation, while also producing a finished result
that is driven by observed data.</p></li>
</ol>

<p>Potential problems with supplying <code>detectedTx</code>, and
suggested work-around:</p><ol>
<li><p>If the <code>detectedTx</code> is incorrect, it may not include all
genes defined in <code>tx2geneDF</code>. In principle, this effect is
beneficial, by not producing flat gene-exon models for
genes with no observed data.</p><ul>
<li><p>Workaround: Note that <code><a href='launchSashimiApp.html'>launchSashimiApp()</a></code> has
the option to query <code>"All genes"</code>.</p></li>
<li><p>An alternative workaround is to run <code>flattenExonsBy()</code>
without supplying <code>detectedTx</code>, but providing <code>gene</code> so
this method only produces flat gene-exons for the genes
of interest.</p></li>
</ul></li>
<li><p>The sashimi plot may represent exon coverage as if it were
an intron, thus compressing the width of that coverage inside
an intron context. However, the coverage will be displayed,
giving a visual indicator that it may need to be reviewed
in more detail.</p></li>
</ol>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other jam RNA-seq functions: 
<code><a href='assignGRLexonNames.html'>assignGRLexonNames</a>()</code>,
<code><a href='closestExonToJunctions.html'>closestExonToJunctions</a>()</code>,
<code><a href='combineGRcoverage.html'>combineGRcoverage</a>()</code>,
<code><a href='defineDetectedTx.html'>defineDetectedTx</a>()</code>,
<code><a href='detectedTxInfo.html'>detectedTxInfo</a>()</code>,
<code><a href='exoncov2polygon.html'>exoncov2polygon</a>()</code>,
<code><a href='groups2contrasts.html'>groups2contrasts</a>()</code>,
<code><a href='makeTx2geneFromGtf.html'>makeTx2geneFromGtf</a>()</code>,
<code><a href='make_ref2compressed.html'>make_ref2compressed</a>()</code>,
<code><a href='runDiffSplice.html'>runDiffSplice</a>()</code>,
<code><a href='sortSamples.html'>sortSamples</a>()</code>,
<code><a href='spliceGR2junctionDF.html'>spliceGR2junctionDF</a>()</code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by James M. Ward, Shannon Farris.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


