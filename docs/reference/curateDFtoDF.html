<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Curate data.frame into a data.frame — curateDFtoDF • splicejam</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Curate data.frame into a data.frame — curateDFtoDF" />
<meta property="og:description" content="Curate data.frame into a data.frame" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">splicejam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.63.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/basic-rnaseq-workflow.html">Splicejam basic RNAseq workflow</a>
    </li>
    <li>
      <a href="../articles/create-a-sashimi-plot.html">Create a Sashimi Plot</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/jmw86069/splicejam/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Curate data.frame into a data.frame</h1>
    <small class="dont-index">Source: <a href='http://github.com/jmw86069/splicejam/blob/master/R/jambio-design.R'><code>R/jambio-design.R</code></a></small>
    <div class="hidden name"><code>curateDFtoDF.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Curate data.frame into a data.frame</p>
    </div>

    <pre class="usage"><span class='fu'>curateDFtoDF</span><span class='op'>(</span>
  <span class='va'>x</span>,
  curationL2 <span class='op'>=</span> <span class='cn'>NULL</span>,
  matchWholeString <span class='op'>=</span> <span class='cn'>TRUE</span>,
  trimWhitespace <span class='op'>=</span> <span class='cn'>TRUE</span>,
  whitespace <span class='op'>=</span> <span class='st'>"_ "</span>,
  expandWhitespace <span class='op'>=</span> <span class='cn'>TRUE</span>,
  keepAllColnames <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>data.frame</p></td>
    </tr>
    <tr>
      <th>curationL2</th>
      <td><p>list with curation rules as described above, or
a character vector of yaml files, which will be imported into
a list format using <code><a href='https://rdrr.io/pkg/yaml/man/yaml.load.html'>yaml::yaml.load_file()</a></code>.</p></td>
    </tr>
    <tr>
      <th>matchWholeString, trimWhitespace, whitespace, expandWhitespace</th>
      <td><p>arguments passed to <code><a href='curateVtoDF.html'>curateVtoDF()</a></code>.</p></td>
    </tr>
    <tr>
      <th>keepAllColnames</th>
      <td><p>logical indicating whether to keep all colnames
from <code>x</code> in addition to those created during curation.
<code>keepAllColnames=FALSE</code> will only keep colnames specifically
described in the <code>curationL2</code> list, while <code>keepAllColnames=TRUE</code>
will keep all original colnames, and any colnames added during
the curation steps.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical indicating whether to print verbose output</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments are passed to <code><a href='curateVtoDF.html'>curateVtoDF()</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function takes a data.frame as input, where one or more
columns are expected to be used in data curation to create
another data.frame. This situation is useful when the final
desired data.frame depends upon values in more than one
column of the input data.frame.</p>
<p>Specifically, this function is a wrapper around <code><a href='curateVtoDF.html'>curateVtoDF()</a></code>.</p>
<p>Typically, <code>curationL2</code> is derived from YAML formatted files, and
loaded into a list with this type of setup:</p>
<p><code>curationL2 &lt;- yaml::yaml.load_file("curation.yaml")</code>.</p>
<p>The structure of curationL2:</p><ul>
<li><p><code>curationL2</code> is a list object, whose <code><a href='https://rdrr.io/r/base/names.html'>names(curationL2)</a></code> are values
in <code><a href='https://rdrr.io/r/base/colnames.html'>colnames(x)</a></code> and represent column of data used as input.</p></li>
<li><p>each list element in <code>curationL2</code> is also a list, whose
<code>names</code> represent colnames to create or update in the output
<code>data.frame</code>.</p></li>
<li><p>these lists contain character vectors <code>length=2</code> containing
a regular expression substitution pattern (see <code><a href='https://rdrr.io/r/base/grep.html'>base::gsub</a></code>),
and a replacement pattern.</p></li>
</ul>

<p>The list is processed in order, and names can be repeated as
necessary to apply the proper substitution patterns in the
order required. New columns created during the curation may also
be used in later curation steps.</p>
<p>Example curation.yaml YAML format. Take note that there is
required leading space in the format.</p>
<pre>
<span class='va'>From_ColnameA</span><span class='op'>:</span>
  <span class='va'>To_ColnameC</span><span class='op'>:</span>
  <span class='op'>-</span> <span class='op'>-</span> <span class='va'>patternA</span>
    <span class='op'>-</span> <span class='va'>replacementA</span>
  <span class='op'>-</span> <span class='op'>-</span> <span class='va'>patternB</span>
    <span class='op'>-</span> <span class='va'>replacementB</span>
  <span class='va'>To_ColnameD</span><span class='op'>:</span>
  <span class='op'>-</span> <span class='op'>-</span> <span class='va'>patternC</span>
    <span class='op'>-</span> <span class='va'>replacementC</span>
  <span class='op'>-</span> <span class='op'>-</span> <span class='va'>patternD</span>
    <span class='op'>-</span> <span class='va'>replacementD</span>
<span class='va'>From_ColnameB</span><span class='op'>:</span>
  <span class='va'>To_ColnameE</span><span class='op'>:</span>
  <span class='op'>-</span> <span class='op'>-</span> <span class='va'>patternE</span>
    <span class='op'>-</span> <span class='va'>replacementE</span>
  <span class='op'>-</span> <span class='op'>-</span> <span class='va'>patternF</span>
    <span class='op'>-</span> <span class='va'>replacementF</span>
</pre>

<p>When the rule creates a colname already present in colnames(x),
then only values specifically matched by the substitution patterns
are modified. For example, this technique can be used to modify
the group assignment of a Sample_ID:</p>
<pre>
<span class='va'>Sample_ID</span><span class='op'>:</span>
  <span class='va'>Group</span><span class='op'>:</span>
  <span class='op'>-</span> <span class='op'>-</span> <span class='va'>Sample1234</span>
    <span class='op'>-</span> <span class='va'>WildType</span>
</pre>

<p>The rules above will match <code>"Sample1234"</code> in the <code>"Sample_ID"</code> column
of x, and assign <code>"WildType"</code> to the <code>"Group"</code> column only for
matching entries.</p>
<p>In addition to values in <code><a href='https://rdrr.io/r/base/colnames.html'>colnames(x)</a></code>, the "from" value may
also be <code>"rownames"</code> which will cause the curation rules to
act upon values in <code><a href='https://rdrr.io/r/base/colnames.html'>rownames(x)</a></code> instead of values in a specific
column of <code>x</code>.</p>
<p>Note that if a "to" column does not already exist, then all values
in the "from" column which do not match any substitution pattern
will be used to fill the remainder of the "to" column.
Once the "to" column exists, then only entries with a matching
substitution pattern are replaced using the replacement pattern.</p>
<p>For example, for NanoString data, the column <code>"CartridgeWell"</code> can be
derived from <code><a href='https://rdrr.io/r/base/colnames.html'>rownames(x)</a></code>, after which the new column <code>"CartridgeWell"</code>
can be used in subsequent curation steps.</p>
<p>Additional notes:</p><ul>
<li><p>The substitution pattern is automatically expanded to include the
whole input string, if not already present. For example supplying <code>"WT"</code>
will match <code>"^.*(WT).*$"</code>. However if the substitution pattern is
<code>"^.*(WT).*$"</code> then it will not be expanded.</p></li>
<li><p>When the substitution pattern is expanded, the string is also enclosed
in parentheses <code>"()"</code> which means the replacement can use <code>"\\1"</code> to
use the successfully matched pattern as the output string. For example
if <code>"WT"</code> and <code>"Mutant"</code> are always valid genotypes, then it would
be sufficient to define substitution pattern <code>"WT|Mutant"</code> and
replacement pattern <code>"\\1"</code>.</p></li>
<li><p>When the substitution pattern is expanded, and the string is enclosed
in parentheses, any parentheses in the substitution pattern are therefore
one level deeper, for example <code>"file([A-Z]+)"</code> will be expanded to
<code>"^.*(file([A-Z]+)).*$"</code>. See the example below, where the replacement
pattern uses <code>"\\2"</code> to use only the internal parentheses.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other jam design functions: 
<code><a href='curateVtoDF.html'>curateVtoDF</a>()</code>,
<code><a href='groups2contrasts.html'>groups2contrasts</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>;
<span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>filename<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span>
   <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"file"</span>,
      <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span> <span class='op'>{</span>
         <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='va'>LETTERS</span>, <span class='fl'>5</span><span class='op'>)</span>, collapse<span class='op'>=</span><span class='st'>""</span><span class='op'>)</span>
      <span class='op'>}</span><span class='op'>)</span><span class='op'>)</span>,
   <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"WT"</span>, <span class='st'>"Mut"</span><span class='op'>)</span>, each<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>,
   <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Veh"</span>,<span class='st'>"EtOH"</span><span class='op'>)</span>, <span class='fl'>3</span><span class='op'>)</span>,
   sep<span class='op'>=</span><span class='st'>"_"</span><span class='op'>)</span><span class='op'>)</span>;
<span class='va'>df</span>;
</div><div class='output co'>#&gt;             filename
#&gt; 1   fileOSNCJ_WT_Veh
#&gt; 2  fileRVKET_WT_EtOH
#&gt; 3   fileNVESI_WT_Veh
#&gt; 4 fileCHGJI_Mut_EtOH
#&gt; 5  fileSDNQK_Mut_Veh
#&gt; 6 fileOSNCJ_Mut_EtOH</div><div class='input'>
<span class='co'># Note a couple ways of accomplishing similar results:</span>
<span class='co'># Genotype matches "WT|wildtype" and replaces with "WT",</span>
<span class='co'># then matches "Mut|mutant" and replaces with "Mut"</span>
<span class='co'>#</span>
<span class='co'># Treatment matches "Veh|EtOH" and simply replaces with</span>
<span class='co'># whatever was matched</span>
<span class='va'>curationYaml</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
<span class='st'>"filename:
  Genotype:
  - - WT|wildtype
    - WT
  - - Mut|mutant
    - Mut
  Treatment:
  - - Veh|EtOH
    - \\1
  File:
  - - file([A-Z]+)
    - \\1
  FileStem:
  - - file([A-Z]+)
    - \\2"</span><span class='op'>)</span>;
<span class='co'># print the curation.yaml to show its structure</span>
<span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='va'>curationYaml</span><span class='op'>)</span>
</div><div class='output co'>#&gt; filename:
#&gt;   Genotype:
#&gt;   - - WT|wildtype
#&gt;     - WT
#&gt;   - - Mut|mutant
#&gt;     - Mut
#&gt;   Treatment:
#&gt;   - - Veh|EtOH
#&gt;     - \1
#&gt;   File:
#&gt;   - - file([A-Z]+)
#&gt;     - \1
#&gt;   FileStem:
#&gt;   - - file([A-Z]+)
#&gt;     - \2</div><div class='input'><span class='va'>curationL</span> <span class='op'>&lt;-</span> <span class='fu'>yaml</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/yaml/man/yaml.load.html'>yaml.load</a></span><span class='op'>(</span><span class='va'>curationYaml</span><span class='op'>)</span>;
<span class='fu'>curateDFtoDF</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>curationL</span><span class='op'>)</span>;
</div><div class='output co'>#&gt; ##  (<span style='color: #00D7D7;font-weight: bold;'>19:08:21</span><span>) 09Mar2021:  </span><span style='color: #FF8700;'>curateDFtoDF(): </span><span style='color: #00AFFF;'>Applying curation to column:</span><span style='color: #FF8700;'>filename</span><span> 
#&gt; ##  (</span><span style='color: #00D7D7;font-weight: bold;'>19:08:21</span><span>) 09Mar2021:  </span><span style='color: #FF8700;'>curateVtoDF(): </span><span style='color: #00AFFF;'>Creating column:</span><span style='color: #FF8700;'>Genotype</span><span> 
#&gt; ##  (</span><span style='color: #00D7D7;font-weight: bold;'>19:08:21</span><span>) 09Mar2021:  </span><span style='color: #FF8700;'>curateVtoDF(): </span><span style='color: #00AFFF;'>Creating column:</span><span style='color: #FF8700;'>Treatment</span><span> 
#&gt; ##  (</span><span style='color: #00D7D7;font-weight: bold;'>19:08:21</span><span>) 09Mar2021:  </span><span style='color: #FF8700;'>curateVtoDF(): </span><span style='color: #00AFFF;'>Creating column:</span><span style='color: #FF8700;'>File</span><span> 
#&gt; ##  (</span><span style='color: #00D7D7;font-weight: bold;'>19:08:21</span><span>) 09Mar2021:  </span><span style='color: #FF8700;'>curateVtoDF(): </span><span style='color: #00AFFF;'>Creating column:</span><span style='color: #FF8700;'>FileStem</span><span> </div><div class='output co'>#&gt;   Genotype Treatment      File FileStem           filename
#&gt; 1       WT       Veh fileOSNCJ    OSNCJ   fileOSNCJ_WT_Veh
#&gt; 2       WT      EtOH fileRVKET    RVKET  fileRVKET_WT_EtOH
#&gt; 3       WT       Veh fileNVESI    NVESI   fileNVESI_WT_Veh
#&gt; 4      Mut      EtOH fileCHGJI    CHGJI fileCHGJI_Mut_EtOH
#&gt; 5      Mut       Veh fileSDNQK    SDNQK  fileSDNQK_Mut_Veh
#&gt; 6      Mut      EtOH fileOSNCJ    OSNCJ fileOSNCJ_Mut_EtOH</div><div class='input'>
</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by James M. Ward, Shannon Farris.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


