<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Define detected transcripts — defineDetectedTx • splicejam</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Define detected transcripts — defineDetectedTx" />
<meta property="og:description" content="Define detected transcripts" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">splicejam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.63.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/basic-rnaseq-workflow.html">Splicejam basic RNAseq workflow</a>
    </li>
    <li>
      <a href="../articles/create-a-sashimi-plot.html">Create a Sashimi Plot</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/jmw86069/splicejam/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Define detected transcripts</h1>
    <small class="dont-index">Source: <a href='http://github.com/jmw86069/splicejam/blob/master/R/jambio-tx.R'><code>R/jambio-tx.R</code></a></small>
    <div class="hidden name"><code>defineDetectedTx.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Define detected transcripts</p>
    </div>

    <pre class="usage"><span class='fu'>defineDetectedTx</span><span class='op'>(</span>
  iMatrixTx <span class='op'>=</span> <span class='cn'>NULL</span>,
  iMatrixTxGrp <span class='op'>=</span> <span class='cn'>NULL</span>,
  iMatrixTxTPM <span class='op'>=</span> <span class='cn'>NULL</span>,
  iMatrixTxTPMGrp <span class='op'>=</span> <span class='cn'>NULL</span>,
  groups <span class='op'>=</span> <span class='cn'>NULL</span>,
  tx2geneDF <span class='op'>=</span> <span class='cn'>NULL</span>,
  cutoffTxPctMax <span class='op'>=</span> <span class='fl'>10</span>,
  cutoffTxExpr <span class='op'>=</span> <span class='fl'>5</span>,
  cutoffTxTPMExpr <span class='op'>=</span> <span class='fl'>0.1</span>,
  txColname <span class='op'>=</span> <span class='st'>"transcript_id"</span>,
  geneColname <span class='op'>=</span> <span class='st'>"gene_name"</span>,
  zeroAsNA <span class='op'>=</span> <span class='cn'>TRUE</span>,
  applyTxPctTo <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"TPM"</span>, <span class='st'>"counts"</span>, <span class='st'>"both"</span>, <span class='st'>"either"</span><span class='op'>)</span>,
  useMedian <span class='op'>=</span> <span class='cn'>FALSE</span>,
  floorTPM <span class='op'>=</span> <span class='fl'>0.001</span>,
  floorCounts <span class='op'>=</span> <span class='fl'>0.001</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>iMatrixTx</th>
      <td><p>numeric matrix of read counts (or pseudocounts) with
transcript rows and sample columns. This data is assumed to be
log2-transformed, and if any value is higher than 50, it will
be log2-transformed with <code><a href='https://rdrr.io/r/base/Log.html'>log2(x+1)</a></code>.</p></td>
    </tr>
    <tr>
      <th>iMatrixTxGrp</th>
      <td><p>numeric matrix of read counts averaged by sample
group. If this matrix is not provided, it will be calculated
from <code>iMatrixTx</code>
using <code><a href='https://rdrr.io/pkg/jamba/man/rowGroupMeans.html'>jamba::rowGroupMeans()</a></code> and the <code>groups</code> parameter.
This data is assumed to be
log2-transformed, and if any value is higher than 50, it will
be log2-transformed with <code><a href='https://rdrr.io/r/base/Log.html'>log2(x+1)</a></code>.</p></td>
    </tr>
    <tr>
      <th>iMatrixTxTPM</th>
      <td><p>numeric matrix of TPM values, with sample columns
and transcript rows. Note that if this parameter is not supplied,
the counts in <code>iMatrixTx</code> will be used to determine the percent
max isoform expression.</p></td>
    </tr>
    <tr>
      <th>iMatrixTxTPMGrp</th>
      <td><p>numeric matrix of TPM values averaged by sample
group. If this matrix is not provided, it will be calculated
from <code>iMatrixTxTPM</code>
using <code><a href='https://rdrr.io/pkg/jamba/man/rowGroupMeans.html'>jamba::rowGroupMeans()</a></code> and the <code>groups</code> parameter.</p></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>vector of group labels, either as character vector
or factor. It should be named by <code><a href='https://rdrr.io/r/base/colnames.html'>colnames(iMatrixTx)</a></code>.</p></td>
    </tr>
    <tr>
      <th>tx2geneDF</th>
      <td><p>data.frame with colnames including
<code><a href='https://rdrr.io/r/base/c.html'>c("transcript_id","gene_name")</a></code>, where the values in the
<code>"transcript_id"</code> column must match the <code><a href='https://rdrr.io/r/base/colnames.html'>rownames(iMatrixTx)</a></code>.</p></td>
    </tr>
    <tr>
      <th>cutoffTxPctMax</th>
      <td><p>numeric value scaled from 0 to 100
indicating the percentage of
the maximum isoform expression per gene, for an alternate isoform
to be considered for detection.</p></td>
    </tr>
    <tr>
      <th>cutoffTxExpr</th>
      <td><p>numeric value indicating the minimum group mean
counts in <code>iMatrixTxGrp</code> for a transcript to be considered for
detection.</p></td>
    </tr>
    <tr>
      <th>cutoffTxTPMExpr</th>
      <td><p>numeric value indicating the minimum group mean
TPM in <code>iMatrixTxTPMGrp</code> for a transcript to be considered for
detection.</p></td>
    </tr>
    <tr>
      <th>txColname, geneColname</th>
      <td><p>the <code><a href='https://rdrr.io/r/base/colnames.html'>colnames(tx2geneDF)</a></code> representing
the <code><a href='https://rdrr.io/r/base/colnames.html'>rownames(iMatrixTx)</a></code> matched by <code>tx2geneDF[,txColname]</code>,
and the associated genes given by <code>tx2geneDF[,geneColname]</code>.
Note that <code>detectedTx</code> must also contain values in
<code><a href='https://rdrr.io/r/base/colnames.html'>rownames(iMatrixTx)</a></code> and <code>tx2geneDF[,txColname]</code>.</p></td>
    </tr>
    <tr>
      <th>zeroAsNA</th>
      <td><p>logical indicating whether values of zero
(or less than zero) should
be treated as <code>NA</code> values, thus removing them from mean
calculations. This argument is only relevant when <code>iMatrixTxGrp</code>
and <code>iMatrixTxTPMGrp</code> are not supplied.
Argument <code>zeroAsNA=TRUE</code> is recommended when using kmer
quantitation tools such as Salmon or Kallisto, which can
sometimes allocate all expression to one or another transcript
isoform when two isoforms are nearly identical. Also use
<code>TRUE</code> when a value of zero represents the absense of data.</p></td>
    </tr>
    <tr>
      <th>applyTxPctTo</th>
      <td><p><code>character</code> string indicating how to apply the
<code>cutoffTcPctMax</code> threshold. This argument is only used when
both <code>iMatrixTx</code> and <code>iMatrixTxTPM</code> are supplied, as follows:
<code>"TPM"</code>: uses only <code>iMatrixTxTPM</code> data; <code>"counts"</code> uses only
<code>iMatrixTx</code> data; <code>"both"</code> requires both <code>iMatrixTx</code> and
<code>iMatrixTxTPM</code> data meet the threshold; <code>"either"</code> requires
that one or both of <code>iMatrixTx</code> and <code>iMatrixTxTPM</code> meet the
threshold.</p></td>
    </tr>
    <tr>
      <th>useMedian</th>
      <td><p>logical indicating whether to use group median
values instead of group mean values.</p></td>
    </tr>
    <tr>
      <th>floorTPM, floorCounts</th>
      <td><p><code>numeric</code> value indicating the floor
value to use when isoform TPM or counts are below <code>1</code>, used
to prevent divide-by-zero when all isoforms are <code>0</code>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical indicating whether to print verbose output.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List with the following elements:</p><dl>
<dt>txExprGrpTx</dt><dd><p>Numeric matrix representing the expression
counts per transcript, grouped by <code>"gene_name"</code>.</p></dd>
<dt>txPctMaxTxGrpAll</dt><dd><p>Numeric matrix representing the
percent expression of each transcript isoform per gene, as
compared to the highest expression of isoforms for that gene,
using <code>iMatrixTxGrp</code> data.
(New to verion 0.0.61.900.)</p></dd>
<dt>txPctMaxTxTPMGrpAll</dt><dd><p>Numeric matrix representing the
percent expression of each transcript isoform per gene, as
compared to the highest expression of isoforms for that gene,
using <code>iMatrixTxTPMGrp</code> data. This data is returned only
if <code>iMatrixTxTPM</code> or <code>iMatrixTxTPMGrp</code> were supplied.
(New to verion 0.0.61.900.)</p></dd>
<dt>txPctMaxGrpAll</dt><dd><p>Numeric matrix representing the
percent max expression used for filtering, after applying
<code>applyTxPctTo</code>: <code>"counts"</code> uses <code>txPctMaxTxGrpAll</code>;
<code>"TPM"</code> uses <code>txPctMaxTxTPMGrpAll</code>; <code>"both"</code> uses the higher
of <code>txPctMaxTxGrpAll</code> and <code>txPctMaxTxTPMGrpAll</code>; <code>"either"</code>
uses the lower of <code>txPctMaxTxGrpAll</code> and <code>txPctMaxTxTPMGrpAll</code>.</p></dd>
<dt>txExprGrpAll</dt><dd><p>Numeric matrix of sample group counts,
exponentiated and rounded to integer values.</p></dd>
<dt>txTPMExprGrpAll</dt><dd><p>Numeric matrix of sample group TPM values,
exponentiated and rounded to integer values.</p></dd>
<dt>txFilterM</dt><dd><p>Numeric matrix indicating whether each isoform met
the criteria to be considered detected. The criteria must be
met in the same group for an isoform to be considered detected.</p></dd>
<dt>detectedTx</dt><dd><p>Character vector of transcripts, as defined by
the <code><a href='https://rdrr.io/r/base/colnames.html'>rownames(iMatrixTx)</a></code>.</p></dd>

</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function aims to combine evidence from RNA-seq sequence
read counts (or pseudocounts from a kmer tool such as Salmon or
Kallisto), along with alternative TPM quantitation, to determine
the observed "detected" transcript space for a given experiment.</p>
<p>Each input data matrix is assumed to be appropriately log-transformed,
typically using <code><a href='https://rdrr.io/r/base/Log.html'>log2(1+x)</a></code>. If any value is <code>&gt;= 50</code> then the data
matrix will be log2-transformed using <code><a href='https://rdrr.io/r/base/Log.html'>log2(1+x)</a></code>.</p>
<p>The criteria must be met in at least one sample group, but all
criteria must be met in the same sample group for an isoform to
be considered "detected".</p>
<p>In our experience the use of TPM values appears more robust and
is conceptually the best approach for comparing the relative
quantity of one transcript isoform to another. Our reasoning is
that TPM is intended to be roughly a molar quantity of transcript
molecules, independent of the transcript length, and the potential
for overlapping regions between isoforms. We also recommend the use
of a kmer quantitation method, such as Salmon or Kallisto, which
estimates isoform abundances not by specific read counts, but by
quantifying kmers unique to particular isoforms for a given gene.</p>
<p>In all cases, the thresholds for detection can be modified, however
from our experiences thus far the default values perform reasonably
well at identifying expressed isoforms, while filtering out isoforms
that we considered to be spuriously expressed.</p>
<p>There are three default requirements for a transcript to be considered
"detected".</p><ol>
<li><p>An isoform must be expressed at least 10% of the max isoform for
a given gene, using TPM values.</p></li>
<li><p>An isoform must have at least log2(32) pseudocounts to be considered
detected, based upon our view of Salmon pseudocount data using MA-plots.</p></li>
<li><p>An isoform must have at least log2(2) TPM units to be considered
detected, based upon our view of Salmon TPM values using MA-plots.</p></li>
</ol>

<p>Each experiment is likely to be different in terms of total
sequenced reads, quality of read alignment or quantitation to the
transcriptome, etc. We suggest observing MA-plots for the counts and
TPM values, for the point at which the signal substantially increases
from baseline zero. We also plotted the TPM versus count per sample,
noted the point at which the two signals began to correlate. These
observations along with careful review of numerous gene model
transcript isoforms supported our selection of these criteria.</p>
<p>Lastly, the requirement for 10 percent of max isoform expression
was motivated by observing highly expressed genes, which sometimes had
alternative isoforms with extremely low abundance compared to the
most abundant isoform, but which was notably higher than the minimum
for detection. For example Gapdh expression above 100,000 pseudocounts,
may have an isoform with 120 pseudocounts. When we reviewed the sequence
coverage, we could find no compelling evidence to support the minor
isoform, and theorized that the pseudocounts arose from the stochastic
nature of rebalancing relative expression among isoforms.</p>
<p>Note the argument <code>zeroAsNA=TRUE</code>, which by default treats any
expression value of zero (or less than zero) as <code>NA</code>,
thus removing them from group
mean calculations. When <code>iMatrixTxGrp</code> and <code>iMatrixTxTPMGrp</code>
are not supplied, this option is helpful in calculating a more
appropriate group mean expression value, notably when a
value of zero represents absence of data. Any group mean that is
<code>NA</code> as a result is converted to zero for the purpose of applying
filters.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other jam RNA-seq functions: 
<code><a href='assignGRLexonNames.html'>assignGRLexonNames</a>()</code>,
<code><a href='closestExonToJunctions.html'>closestExonToJunctions</a>()</code>,
<code><a href='combineGRcoverage.html'>combineGRcoverage</a>()</code>,
<code><a href='detectedTxInfo.html'>detectedTxInfo</a>()</code>,
<code><a href='exoncov2polygon.html'>exoncov2polygon</a>()</code>,
<code><a href='flattenExonsBy.html'>flattenExonsBy</a>()</code>,
<code><a href='groups2contrasts.html'>groups2contrasts</a>()</code>,
<code><a href='makeTx2geneFromGtf.html'>makeTx2geneFromGtf</a>()</code>,
<code><a href='make_ref2compressed.html'>make_ref2compressed</a>()</code>,
<code><a href='runDiffSplice.html'>runDiffSplice</a>()</code>,
<code><a href='sortSamples.html'>sortSamples</a>()</code>,
<code><a href='spliceGR2junctionDF.html'>spliceGR2junctionDF</a>()</code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by James M. Ward, Shannon Farris.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


