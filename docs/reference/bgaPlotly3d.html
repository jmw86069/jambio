<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create an interactive 3-D BGA plotly visualization — bgaPlotly3d • splicejam</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create an interactive 3-D BGA plotly visualization — bgaPlotly3d" />
<meta property="og:description" content="Create an interactive 3-D BGA plotly visualization" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">splicejam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.63.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/basic-rnaseq-workflow.html">Splicejam basic RNAseq workflow</a>
    </li>
    <li>
      <a href="../articles/create-a-sashimi-plot.html">Create a Sashimi Plot</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/jmw86069/splicejam/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create an interactive 3-D BGA plotly visualization</h1>
    <small class="dont-index">Source: <a href='http://github.com/jmw86069/splicejam/blob/master/R/splicejam-plots.R'><code>R/splicejam-plots.R</code></a></small>
    <div class="hidden name"><code>bgaPlotly3d.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create an interactive 3-D BGA plotly visualization</p>
    </div>

    <pre class="usage"><span class='fu'>bgaPlotly3d</span><span class='op'>(</span>
  <span class='va'>bgaInfo</span>,
  axes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>,
  superGroups <span class='op'>=</span> <span class='cn'>NULL</span>,
  superGroupAlpha <span class='op'>=</span> <span class='fl'>0.3</span>,
  superGroupLwd <span class='op'>=</span> <span class='fl'>25</span>,
  arrowSmoothFactor <span class='op'>=</span> <span class='fl'>8</span>,
  colorSub <span class='op'>=</span> <span class='cn'>NULL</span>,
  drawVectors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"none"</span>, <span class='st'>"centroids"</span>, <span class='st'>"genes"</span><span class='op'>)</span>,
  highlightGenes <span class='op'>=</span> <span class='cn'>NULL</span>,
  drawSampleLabels <span class='op'>=</span> <span class='cn'>TRUE</span>,
  ellipseType <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ellipsoid"</span>, <span class='st'>"alphahull"</span>, <span class='st'>"none"</span><span class='op'>)</span>,
  ellipseOpacity <span class='op'>=</span> <span class='fl'>0.2</span>,
  useScaledCoords <span class='op'>=</span> <span class='cn'>FALSE</span>,
  geneColor <span class='op'>=</span> <span class='st'>"#555555"</span>,
  geneScaleFactor <span class='op'>=</span> <span class='fl'>1</span>,
  geneLwd <span class='op'>=</span> <span class='fl'>2</span>,
  geneAlpha <span class='op'>=</span> <span class='fl'>0.7</span>,
  geneLabels <span class='op'>=</span> <span class='cn'>NULL</span>,
  maxGenes <span class='op'>=</span> <span class='fl'>50</span>,
  centroidLwd <span class='op'>=</span> <span class='fl'>15</span>,
  centroidAlpha <span class='op'>=</span> <span class='fl'>0.3</span>,
  textposition_centroid <span class='op'>=</span> <span class='st'>"top center"</span>,
  textposition_sample <span class='op'>=</span> <span class='st'>"middle right"</span>,
  sceneX <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1.25</span>,
  sceneY <span class='op'>=</span> <span class='fl'>1.25</span>,
  sceneZ <span class='op'>=</span> <span class='fl'>1.25</span>,
  main <span class='op'>=</span> <span class='st'>""</span>,
  plot_bgcolor <span class='op'>=</span> <span class='st'>"#eeeeee"</span>,
  paper_bgcolor <span class='op'>=</span> <span class='st'>"#dddddd"</span>,
  sampleGroups <span class='op'>=</span> <span class='cn'>NULL</span>,
  debug <span class='op'>=</span> <span class='cn'>FALSE</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>bgaInfo</th>
      <td><p>object of class <code>"bga"</code> as created by <code><a href='https://rdrr.io/pkg/made4/man/bga.html'>made4::bga()</a></code>.</p></td>
    </tr>
    <tr>
      <th>axes</th>
      <td><p>integer vector length 3 indicating the BGA axes to use
for the 3-D visualization. It is sometimes helpful to use
<code>axes=c(2,3,4)</code> especially when the first component suggests
a large experimental batch effect, for example when
combining data from multiple GEO studies, often the first
BGA component is indicative of the different experimental
platforms.</p></td>
    </tr>
    <tr>
      <th>superGroups</th>
      <td><p>character or factor vector with length
<code><a href='https://rdrr.io/r/base/length.html'>length(bgaInfo$fac)</a></code>, in the same order. A super group consists
of multiple sample groups, as defined by values in <code>bgaInfo$fac</code>.</p></td>
    </tr>
    <tr>
      <th>superGroupAlpha</th>
      <td><p>numeric value between 0 and 1 indicating the
alpha transparency to use for the vector that connects groups
within each super group.</p></td>
    </tr>
    <tr>
      <th>superGroupLwd</th>
      <td><p>the line width when connecting sample group
centroids by <code>superGroups</code>.</p></td>
    </tr>
    <tr>
      <th>arrowSmoothFactor</th>
      <td><p>numeric value typically ranging from 1 to 5,
affecting the amount of curve smoothing when generating a
3-D spline curve to connect more than two super groups.
When there are only two group members in one super group,
the two groups will always use a straight line. For three or
more groups, a 3-D spline is used, in order to help visualize
trends by means of a curve.</p></td>
    </tr>
    <tr>
      <th>colorSub</th>
      <td><p>named color vector, whose names contain values in
<code>bgaInfo$fac</code>. These colors are used for the samples, sample
centroids, and are shaded via a gradient when connecting multiple
centroids using <code>superGroups</code>.</p></td>
    </tr>
    <tr>
      <th>drawVectors</th>
      <td><p>character vector of one or more types of vectors,
where <code>"centroids"</code> draws a vector from the origin to each group
centroid; and <code>"genes"</code> draws a vector from the origin to each
gene.</p></td>
    </tr>
    <tr>
      <th>drawSampleLabels</th>
      <td><p>logical indicating whether to label each
individual sample point, as opposed to labeling only the
sample group centroid.</p></td>
    </tr>
    <tr>
      <th>ellipseOpacity</th>
      <td><p>numeric value between 0 and 1 indicating the
transparency of the ellipse, when <code>ellipseType</code> is not <code>"none"</code>;
0 is fully transparent, and 1 is non-transparent.</p></td>
    </tr>
    <tr>
      <th>useScaledCoords</th>
      <td><p>logical indicating whether to use the BGA
scaled coordinates, or the raw coordinates. By default the raw
coordinates are used in order to preserve the relative contribution
of each BGA component to the overall variability (or inertial
moment.)</p></td>
    </tr>
    <tr>
      <th>geneColor</th>
      <td><p>character color used when displaying gene points.</p></td>
    </tr>
    <tr>
      <th>geneScaleFactor</th>
      <td><p>numeric value used to expand the position of
genes relative to the origin, intended to help visualize the vector
position of genes relative to the origin.</p></td>
    </tr>
    <tr>
      <th>geneLwd, geneAlpha</th>
      <td><p>parameters used to customize the line width
and alpha transparency of gene points, respectively.</p></td>
    </tr>
    <tr>
      <th>geneLabels</th>
      <td><p>character vector of gene labels to use instead
of rownames. The <code><a href='https://rdrr.io/r/base/names.html'>names(geneLabels)</a></code> are expected to match
<code><a href='https://rdrr.io/r/base/colnames.html'>rownames(bgaInfo$bet$co)</a></code>. This option is intended to allow
display of gene symbols, instead of an assay identifier like
probe set name.</p></td>
    </tr>
    <tr>
      <th>maxGenes</th>
      <td><p>integer maximum number of genes to display.</p></td>
    </tr>
    <tr>
      <th>centroidLwd, centroidAlpha</th>
      <td><p>parameters used to customize the
line width and alpha transparency of vectors drawn to sample
centroids, respectively.</p></td>
    </tr>
    <tr>
      <th>textposition_centroid, textposition_sample</th>
      <td><p>character vector
containing values used as the <code>plotly</code> argument <code>"textposition"</code>
to position text labels for centroids, and samples. Each
vector is extended to the number of labels, which allows
each label to be individually positioned.</p></td>
    </tr>
    <tr>
      <th>sceneX, sceneY, sceneZ</th>
      <td><p>parameters used to define the camera
position in 3-D space as defined by plotly. Frankly, the ability
to customize the starting position is fairly confusing, but these
values are faithfully passed along to the corresponding plotly
call.</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>character string used as a title on the plotly
visualization.</p></td>
    </tr>
    <tr>
      <th>sampleGroups</th>
      <td><p>vector of character or factor values. The
names are expected to contain values in
<code><a href='https://rdrr.io/r/base/colnames.html'>rownames(bgaInfo$ord$ord$tab)</a></code>, which are also the colnames
of the data matrix used in <code><a href='https://rdrr.io/pkg/made4/man/bga.html'>made4::bga()</a></code>. The values in
<code>sampleGroups</code> are used to re-group samples, which effectively
calculates new sample group centroids used in this
visualization. It is intended to be used when the <code><a href='https://rdrr.io/pkg/made4/man/bga.html'>made4::bga()</a></code>
is used without grouping, for example when each sample replicate
is defined as its own group.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical indicating whether to print verbose output.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional parameters are ignored</p></td>
    </tr>
    <tr>
      <th>elipseType</th>
      <td><p>character value indicating how to draw sample
centroid ellipses, where <code>"none"</code> draws no ellipse; <code>"alphahull"</code>
draws a wireframe; and <code>"ellipsoid"</code> draws
a partially transparent shell. Note that plotly does not handle
transparency well in 3-D space, sometimes fully obscuring
background components.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>plotly object sufficient to render an HTML page containing
a 3-D BGA plot.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function takes the output from <code><a href='https://rdrr.io/pkg/made4/man/bga.html'>made4::bga()</a></code> (class <code>"bga"</code>)
and creates a 3D plotly visualization which shows the samples,
sample centroids, and optionally a subset of genes in the same
BGA component space.</p>
<p>For general guidance, when the data contains four or more sample
groups, this function can be called to produce a 3-D plot.
BGA itself produces <code>n-1</code> dimensions, therefore when there are
fewer than four groups, a 3-D plot cannot be produced.</p>
<p>When analyzing data with fewer than four groups, it is sometimes
helpful to cluster samples individually. This approach is roughly
equivalent to performing PCA or COA directly, but is sometimes
convenient in being consistent with calling <code><a href='https://rdrr.io/pkg/made4/man/bga.html'>made4::bga()</a></code>, as
it also applies the same scaling method used in <code>made4:bga()</code>
prior to calling PCA or COA. In that case, the groups can still
be displayed by <code>bgaPlotly3d()</code> by defining the <code>sampleGroups</code>
argument. The result will display typical PCA or COA coordinates,
but visually displays the centroid of each sample group.</p>
<p>This function is especially useful when there are multiple
sample groups that belong to a "supergroup" -- a higher level
of grouping. Consider an experiment with two cell lines treated
over multiple time points. The samples would be assigned to
a group based upon cell_line and time, then each group would
be assigned to a supergroup based upon cell_line. The output
plot will display each sample group, group centroid, then
connect group centroids in order by the supergroup.
The order of groups within each supergroup is determined
either by factor levels, or by the order returned by
<code><a href='https://rdrr.io/pkg/jamba/man/mixedSort.html'>jamba::mixedSort()</a></code> which performs a proper alphanumeric sort.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other jam plot functions: 
<code><a href='factor2label.html'>factor2label</a>()</code>,
<code><a href='gene2gg.html'>gene2gg</a>()</code>,
<code><a href='grl2df.html'>grl2df</a>()</code>,
<code><a href='jitter_norm.html'>jitter_norm</a>()</code>,
<code><a href='plotSashimi.html'>plotSashimi</a>()</code>,
<code><a href='prepareSashimi.html'>prepareSashimi</a>()</code>,
<code><a href='stackJunctions.html'>stackJunctions</a>()</code></p>
<p>Other jam spatial functions: 
<code><a href='compressPolygonM.html'>compressPolygonM</a>()</code>,
<code><a href='dfWide2segments.html'>dfWide2segments</a>()</code>,
<code><a href='simplifyXY.html'>simplifyXY</a>()</code>,
<code><a href='spline3d.html'>spline3d</a>()</code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by James M. Ward, Shannon Farris.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


