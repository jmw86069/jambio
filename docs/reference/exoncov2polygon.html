<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Convert exon coverage to polygons — exoncov2polygon • splicejam</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Convert exon coverage to polygons — exoncov2polygon" />
<meta property="og:description" content="Convert exon coverage to polygons" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">splicejam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.64.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/basic-rnaseq-workflow.html">Splicejam basic RNAseq workflow</a>
    </li>
    <li>
      <a href="../articles/create-a-sashimi-plot.html">Create a Sashimi Plot</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/jmw86069/splicejam/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Convert exon coverage to polygons</h1>
    <small class="dont-index">Source: <a href='http://github.com/jmw86069/splicejam/blob/master/R/jambio-plot.R'><code>R/jambio-plot.R</code></a></small>
    <div class="hidden name"><code>exoncov2polygon.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Convert exon coverage to polygons</p>
    </div>

    <pre class="usage"><span class='fu'>exoncov2polygon</span><span class='op'>(</span>
  <span class='va'>gr</span>,
  covNames <span class='op'>=</span> <span class='cn'>NULL</span>,
  sample_id <span class='op'>=</span> <span class='cn'>NULL</span>,
  baseline <span class='op'>=</span> <span class='cn'>NULL</span>,
  gapWidth <span class='op'>=</span> <span class='fl'>250</span>,
  doPlot <span class='op'>=</span> <span class='cn'>FALSE</span>,
  coord_style <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"fortify"</span>, <span class='st'>"base"</span>, <span class='st'>"list"</span>, <span class='st'>"all"</span><span class='op'>)</span>,
  ref2c <span class='op'>=</span> <span class='cn'>NULL</span>,
  compress_introns <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gr</th>
      <td><p>GRanges where <code><a href='https://rdrr.io/r/base/colnames.html'>colnames(values(gr))</a></code> is present in <code>covNames</code>,
and contains data with class <code>NumericList</code>.</p></td>
    </tr>
    <tr>
      <th>covNames</th>
      <td><p>character vector contained in <code><a href='https://rdrr.io/r/base/colnames.html'>colnames(values(gr))</a></code>.</p></td>
    </tr>
    <tr>
      <th>baseline</th>
      <td><p>numeric vector of length 0, 1 or <code><a href='https://rdrr.io/r/base/length.html'>length(gr)</a></code>. If
<code>baseline</code> has names matching <code><a href='https://rdrr.io/r/base/names.html'>names(gr)</a></code> they will be used for
each <code>gr</code> entry; if <code>baseline</code> is not named, it is extended
to <code><a href='https://rdrr.io/r/base/length.html'>length(gr)</a></code>. The <code>baseline</code> value is added to the coverage
for each exon to offset the polygon as needed.</p></td>
    </tr>
    <tr>
      <th>gapWidth</th>
      <td><p>numeric value sent to <code><a href='make_ref2compressed.html'>make_ref2compressed()</a></code>.</p></td>
    </tr>
    <tr>
      <th>coord_style</th>
      <td><p>character value to define the output style:
<code>"base"</code> returns a matrix with polygons separated by a row of <code>NA</code>
values; <code>"fortify"</code> returns a <code>data.frame</code> intended for ggplot2,
with columns <code>"cov"</code> and <code>"gr"</code> indicating the values in <code>covNames</code> and
<code><a href='https://rdrr.io/r/base/names.html'>names(gr)</a></code> used to separate each polygon.</p></td>
    </tr>
    <tr>
      <th>ref2c</th>
      <td><p>optional list containing output from <code><a href='make_ref2compressed.html'>make_ref2compressed()</a></code>,
used to compress the GRanges coordinates.</p></td>
    </tr>
    <tr>
      <th>compress_introns</th>
      <td><p>logical indicating whether to compress
the coverage polygon coordinates to approximately the same
number of pixels per inch as the exon polygons. This option
greatly reduces the size of the polygon, since introns are
already about 50 to 100 times wider than exons, and when
<code>ref2c</code> is supplied, the introns are visibly compressed
to a fixed width on the x-axis. The data has many more
x-axis coordinates than the data visualization, this argument
is intended to reduce the intron coordinates accordingly.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical indicating whether to print verbose output.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments are ignored.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is a workhorse function that converts a GRanges
object containing column values with NumericList coverage data,
into a full data.frame sufficient to define ggplot2 and other
coverage polygon plots.</p>
<p>An interesting argument is <code>baseline</code> which allows each exon
in the <code>gr</code> GRanges object to be offset from zero, in order to
make certain features visually easier to distinguish.</p>
<p>This function also calls <code><a href='simplifyXY.html'>simplifyXY()</a></code> which reduces the
stored polygon detail for regions whose coordinates are compressed
on the x-axis, taking roughly the max value for each point.</p>
<p>The default output is roughly similar to <code><a href='https://rdrr.io/pkg/generics/man/tidy.html'>broom::tidy()</a></code> in
that it converts a custom R object into a tidy data.frame
suitable for use by ggplot2 and other tidy workflows.</p>
<p>The function <code><a href='getGRcoverageFromBw.html'>getGRcoverageFromBw()</a></code> takes a set of bigWig files
and returns a GRanges object whose columns contain NumericList data,
which is the intended input for <code>exoncov2polygon()</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='test_cov_wide_gr.html'>test_cov_wide_gr()</a></code> for examples</p>
<p>Other jam GRanges functions: 
<code><a href='addGRLgaps.html'>addGRLgaps</a>()</code>,
<code><a href='addGRgaps.html'>addGRgaps</a>()</code>,
<code><a href='annotateGRLfromGRL.html'>annotateGRLfromGRL</a>()</code>,
<code><a href='annotateGRfromGR.html'>annotateGRfromGR</a>()</code>,
<code><a href='assignGRLexonNames.html'>assignGRLexonNames</a>()</code>,
<code><a href='closestExonToJunctions.html'>closestExonToJunctions</a>()</code>,
<code><a href='combineGRcoverage.html'>combineGRcoverage</a>()</code>,
<code><a href='findOverlapsGRL.html'>findOverlapsGRL</a>()</code>,
<code><a href='flattenExonsBy.html'>flattenExonsBy</a>()</code>,
<code><a href='getFirstStrandedFromGRL.html'>getFirstStrandedFromGRL</a>()</code>,
<code><a href='getGRLgaps.html'>getGRLgaps</a>()</code>,
<code><a href='getGRcoverageFromBw.html'>getGRcoverageFromBw</a>()</code>,
<code><a href='getGRgaps.html'>getGRgaps</a>()</code>,
<code><a href='grl2df.html'>grl2df</a>()</code>,
<code><a href='jam_isDisjoint.html'>jam_isDisjoint</a>()</code>,
<code><a href='make_ref2compressed.html'>make_ref2compressed</a>()</code>,
<code><a href='sortGRL.html'>sortGRL</a>()</code>,
<code><a href='spliceGR2junctionDF.html'>spliceGR2junctionDF</a>()</code>,
<code><a href='stackJunctions.html'>stackJunctions</a>()</code></p>
<p>Other jam RNA-seq functions: 
<code><a href='assignGRLexonNames.html'>assignGRLexonNames</a>()</code>,
<code><a href='closestExonToJunctions.html'>closestExonToJunctions</a>()</code>,
<code><a href='combineGRcoverage.html'>combineGRcoverage</a>()</code>,
<code><a href='defineDetectedTx.html'>defineDetectedTx</a>()</code>,
<code><a href='detectedTxInfo.html'>detectedTxInfo</a>()</code>,
<code><a href='flattenExonsBy.html'>flattenExonsBy</a>()</code>,
<code><a href='getGRcoverageFromBw.html'>getGRcoverageFromBw</a>()</code>,
<code><a href='groups2contrasts.html'>groups2contrasts</a>()</code>,
<code><a href='internal_junc_score.html'>internal_junc_score</a>()</code>,
<code><a href='makeTx2geneFromGtf.html'>makeTx2geneFromGtf</a>()</code>,
<code><a href='make_ref2compressed.html'>make_ref2compressed</a>()</code>,
<code><a href='prepareSashimi.html'>prepareSashimi</a>()</code>,
<code><a href='runDiffSplice.html'>runDiffSplice</a>()</code>,
<code><a href='sortSamples.html'>sortSamples</a>()</code>,
<code><a href='spliceGR2junctionDF.html'>spliceGR2junctionDF</a>()</code></p>
<p>Other splicejam core functions: 
<code><a href='gene2gg.html'>gene2gg</a>()</code>,
<code><a href='grl2df.html'>grl2df</a>()</code>,
<code><a href='make_ref2compressed.html'>make_ref2compressed</a>()</code>,
<code><a href='plotSashimi.html'>plotSashimi</a>()</code>,
<code><a href='prepareSashimi.html'>prepareSashimi</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># use some test data</span>
<span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>GenomicRanges</span><span class='op'>)</span><span class='op'>)</span>;
<span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span><span class='op'>)</span>;
</div><div class='output co'>#&gt; <span class='warning'>Warning: package ‘ggplot2’ was built under R version 3.6.2</span></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>test_cov_gr</span><span class='op'>)</span>;
<span class='co'># prepare polygon coordinates</span>
<span class='va'>exondf</span> <span class='op'>&lt;-</span> <span class='fu'>exoncov2polygon</span><span class='op'>(</span><span class='va'>test_cov_gr</span>, covNames<span class='op'>=</span><span class='st'>"sample_A"</span><span class='op'>)</span>;
<span class='co'># create a ggplot</span>
<span class='va'>gg3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>exondf</span>,
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>x</span>, y<span class='op'>=</span><span class='va'>y</span>, group<span class='op'>=</span><span class='va'>gr</span>, fill<span class='op'>=</span><span class='va'>gr</span>, color<span class='op'>=</span><span class='va'>gr</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'>ggforce</span><span class='fu'>::</span><span class='fu'><a href='https://ggforce.data-imaginist.com/reference/geom_shape.html'>geom_shape</a></span><span class='op'>(</span>alpha<span class='op'>=</span><span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'>colorjam</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/colorjam/man/theme_jam.html'>theme_jam</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'>colorjam</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/colorjam/man/scale_fill_jam.html'>scale_fill_jam</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'>colorjam</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/colorjam/man/scale_color_jam.html'>scale_color_jam</a></span><span class='op'>(</span><span class='op'>)</span>;
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>gg3</span><span class='op'>)</span>;
</div><div class='img'><img src='exoncov2polygon-1.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by James M. Ward, Shannon Farris.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


