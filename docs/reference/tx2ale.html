<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>tx2ale: detect alternative last exons (ALE) from transcript data — tx2ale • splicejam</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="tx2ale: detect alternative last exons (ALE) from transcript data — tx2ale" />
<meta property="og:description" content="detect alternative last exons (ALE) from transcript data" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">splicejam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.63.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/basic-rnaseq-workflow.html">Splicejam basic RNAseq workflow</a>
    </li>
    <li>
      <a href="../articles/create-a-sashimi-plot.html">Create a Sashimi Plot</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/jmw86069/splicejam/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>tx2ale: detect alternative last exons (ALE) from transcript data</h1>
    <small class="dont-index">Source: <a href='http://github.com/jmw86069/splicejam/blob/master/R/jambio-tx.R'><code>R/jambio-tx.R</code></a></small>
    <div class="hidden name"><code>tx2ale.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>detect alternative last exons (ALE) from transcript data</p>
    </div>

    <pre class="usage"><span class='fu'>tx2ale</span><span class='op'>(</span>
  gtf <span class='op'>=</span> <span class='cn'>NULL</span>,
  txdb <span class='op'>=</span> <span class='cn'>NULL</span>,
  threeUtrGRL <span class='op'>=</span> <span class='cn'>NULL</span>,
  detectedTx <span class='op'>=</span> <span class='cn'>NULL</span>,
  tx2geneDF <span class='op'>=</span> <span class='cn'>NULL</span>,
  iMatrix <span class='op'>=</span> <span class='cn'>NULL</span>,
  aleMethod <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"first"</span>, <span class='st'>"range"</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gtf</th>
      <td><p>character path to a GTF file, used to import gene models
using Bioconductor <code><a href='https://rdrr.io/pkg/GenomicFeatures/man/makeTxDbFromGFF.html'>GenomicFeatures::makeTxDbFromGFF()</a></code>
to create a transcriptDb object. If supplied, and if <code>tx2geneDF</code>
is NULL, then <code>tx2geneDF</code> will be created using
<code>makeTx2geneFromGtf</code>.</p></td>
    </tr>
    <tr>
      <th>txdb</th>
      <td><p>a <code>TxDb</code> object as defined by Bioconductor
package <code>GenomicFeatures</code>. Note that when reloading an R session,
these objects usually become defunct, since they refer internally to
a sqlite database stored in a temporary file. Therefore, when saving
and reloading an R session, it is recommended to use the relevant
functions <code><a href='https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html'>AnnotationDbi::saveDb</a></code> and
<code><a href='https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html'>AnnotationDbi::loadDb</a></code>.</p></td>
    </tr>
    <tr>
      <th>threeUtrGRL</th>
      <td><p>GRangesList object of 3'UTR exons by transcript, whose
names are available in the <code>tx2geneDF</code> data.frame with colname
<code>transcript_id</code>.</p></td>
    </tr>
    <tr>
      <th>detectedTx</th>
      <td><p>optional character vector of transcripts detected,
whose values match the transcript names in <code>gtf</code>, <code>txdb</code>,
<code>threeUtrGRL</code>, and/or <code>tx2geneDF</code> as relevant to the
supplied input data.</p></td>
    </tr>
    <tr>
      <th>tx2geneDF</th>
      <td><p>optional data.frame with colnames <code>gene_id</code> and
<code>transcript_id</code> which are used to relate transcripts to genes.
If either <code>gtf</code> or <code>txdb</code> are supplied, this data.frame
can be determined from that data.</p></td>
    </tr>
    <tr>
      <th>iMatrix</th>
      <td><p>optional numeric matrix of transcript rows, and sample
columns, containing expression abundance data. When supplied, a
matrix will be created <code>iMatrixByALE</code> where the transcript
abundance values have been aggregated per ALE as defined.</p></td>
    </tr>
    <tr>
      <th>aleMethod</th>
      <td><p>character value describing the method used to define
ALE regions.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical whether to print verbose output during processing.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>aleGRL GRangesList object containing the ALE ranges after
processing. Compare to transcript models to see if 3'UTR regions have
been properly handled.</p>
<p>multiALEgenes vector of gene_name values which contain multiple
ALEs after processing.</p>
<p>tx2ale vector containing ALE_name values, named by transcript_id,
used to aggregate per-transcript data into per-ALE data.</p>
<p>iMatrixByALE optional data matrix created only if iMatrix was
supplied as input. The data matrix rows are ALE_name values after
aggregating transcripts into ALEs. Note that only multi-ALE genes
are included, all single-ALE genes are excluded.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is intended to encapsulate logic used to define
alternative last exons (ALE) based upon gene-transcript models.
Specifically, it uses either the 5' end of all 3'UTR regions
<code>aleMethod="first"</code>, or the full 3'UTR range
<code>aleMethod="range"</code>, optionally using only detected transcripts
if given by <code>detectedTx</code>. Any transcripts overlapping the criteria
above are merged together by gene, to define a unique set of
ALEs for each gene.</p>
<p>Note that when using <code>aleMethod="first"</code>,
3'UTRs will be combined if the 5'end of the
3'UTR is identical, which means the length of the 3'UTR is not considered
in terms of defining an ALE. The goal is to determine whether the ALE is
or is not maintained during transcript processing.</p>
<p>Note that when using <code>aleMethod="range"</code>, 3'UTRs are converted first
to a range, which converts multi-exon 3'UTRs to the full range covered by
the 3'UTR exons, and not specific exon ranges contained. It is mainly
intended to focus on the specific scenario where alternative 3'UTRs for
a give gene do not overlap in any way. In reality, several sources of
GTF gene models showed unusual transcript isoforms that contained premature
stop codons, thus annotating the remaining exons all as "3'UTR" and
therefore causing all subsequent 3'UTR regions to be combined into one
large spanning range. For this reason, we recommend using
<code>aleMethod="first"</code> by default.</p>
<p>We noted substantially improved results when supplying detected transcripts
via the parameter <code>detectedTx</code>, which greatly reduces the full set of
possible ALE regions to use only those regions relevant and observed in the
given RNA-seq dataset. In other words, there are a large number of possible
ALE regions which have no supporting measured data in a particular RNA-seq
experiment. It is possible that generating a superset of ALE regions
may not be practically problematic in downstream analysis steps, however
the impact may be seen predominantly during fase discovery rate (FDR)
adjustment for multiple testing, especially if over half the annotated
ALE regions have zero reported measurements. If they have no supporting
measurements, they are effectively not being tested. As GTF files become
increasingly annotated to cover every possible scenario, this issue is
likely to become more impactful over time.</p>
<p>Input data can be in one of three forms:</p><ul>
<li><p><code>gtf</code> a GTF file such as those GTF files provided by Gencode</p></li>
<li><p><code>txdb</code> a TxDb R object as produced by the Bioconductor
package <code>GenomicFeatures</code>, suitable for use in calling
<code><a href='https://rdrr.io/pkg/GenomicFeatures/man/transcriptsBy.html'>GenomicFeatures::threeUTRsByTranscript()</a></code></p></li>
<li><p><code>threeUtrGRL</code> a <code><a href='https://rdrr.io/pkg/GenomicRanges/man/GRangesList-class.html'>GenomicRanges::GRangesList</a></code> object
which is a list of 3'UTR exons by transcript. This input also requires
<code>tx2geneDF</code> which is used to relate transcripts to genes.</p></li>
</ul>

<p>Two important outputs are <code>tx2ale</code> which converts transcripts to
ALE names, and if a matrix of transcript expression is supplied with
<code>iMatrix</code>, then <code>iMatrixByALE</code> is a matrix of expression
aggregated at the ALE level, suitable for differential testing in
<code><a href='https://rdrr.io/pkg/limma/man/diffSplice.html'>limma::diffSplice()</a></code> or <code>DEXSeq</code>.</p>
<p>This function depends upon custom functions: <code><a href='annotateGRLfromGRL.html'>annotateGRLfromGRL()</a></code>,
<code><a href='annotateGRfromGR.html'>annotateGRfromGR()</a></code>, and <code><a href='assignGRLexonNames.html'>assignGRLexonNames()</a></code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other jam ALE-specific RNA-seq functions: 
<code><a href='ale2violin.html'>ale2violin</a>()</code>,
<code><a href='getFirstStrandedFromGRL.html'>getFirstStrandedFromGRL</a>()</code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by James M. Ward, Shannon Farris.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


